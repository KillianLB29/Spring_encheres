<html data-th-replace="~{layout/layout :: layout(content=~{:: main}, title=~{:: title}, css=~{:: #extraCss})}">
<title>Enchères ENI - Mes enchères</title>
<title>Mes enchères</title>
<div id="extraCss">
    <link rel="stylesheet" data-th-href="@{/css/mesEncheres.css}">
    <link rel="stylesheet" data-th-href="@{/css/mesEncheres_mobile.css}">
</div>
<main>

    <h2 class="titre_mobile_encheres">Mes objets mis en enchère terminés</h2>
    <section class="encheres">
        <div class="carousel">
            <button class="carousel-btn prev">&#10094;</button>
            <div class="card-container">
                <div class="card" th:each="article : ${encheresTerminer}">
                    <div class="card-image">
                        <img th:src="@{/img/lamp-design.jpg}" alt="Image de l'article">
                    </div>
                    <div class="card-content">
                        <h3 th:text="${article.nomArticle}" class="card-title">Nom article</h3>
                        <p><strong>Prix :</strong> <span th:text="${article.miseAPrix} + ' crédits'"></span></p>
                        <p><strong>Fin :</strong> <span th:text="${#dates.format(article.dateFinEncheres, 'dd/MM/yyyy')}"></span></p>
                        <p><strong>Vendeur :</strong> <span th:text="${article.utilisateur.pseudo}"></span></p>
                        <a th:href="@{'/encheres/' + ${article.noArticle}}" class="btn">Voir</a>
                    </div>
                </div>
            </div>
            <button class="carousel-btn next">&#10095;</button>
        </div>
    </section>

    <h2 class="titre_mobile_encheres">Mes objets actuellement en enchères</h2>
    <section class="encheres">
        <div class="carousel">
            <button class="carousel-btn prev">&#10094;</button>
            <div class="card-content">
                <div class="card" th:each="article : ${encheresEnCours}">
                    <div class="card-image">
                        <img th:src="@{/img/lamp-design.jpg}" alt="Image de l'article">
                    </div>
                    <div class="card-content">
                        <h3 th:text="${article.nomArticle}" class="card-title">Nom article</h3>
                        <p><strong>Prix :</strong> <span th:text="${article.miseAPrix} + ' crédits'"></span></p>
                        <p><strong>Fin :</strong> <span th:text="${#dates.format(article.dateFinEncheres, 'dd/MM/yyyy')}"></span></p>
                        <p><strong>Vendeur :</strong> <span th:text="${article.utilisateur.pseudo}"></span></p>
                        <a th:href="@{'/encheres/' + ${article.noArticle}}" class="btn">Voir</a>
                    </div>
                </div>
            </div>
            <button class="carousel-btn next">&#10095;</button>
        </div>
    </section>

    <h2 class="titre_mobile_encheres">Les enchères auxquelles je participe</h2>
    <section class="encheres">
        <div class="carousel">
            <button class="carousel-btn prev">&#10094;</button>
            <div class="card-container">
                <div class="card" th:each="article : ${encheresParticipe}">
                    <div class="card-image">
                        <img th:src="@{/img/lamp-design.jpg}" alt="Image de l'article">
                    </div>
                    <div class="card-content">
                        <h3 th:text="${article.nomArticle}" class="card-title">Nom article</h3>
                        <p><strong>Prix :</strong> <span th:text="${article.miseAPrix} + ' crédits'"></span></p>
                        <p><strong>Fin :</strong> <span th:text="${#dates.format(article.dateFinEncheres, 'dd/MM/yyyy')}"></span></p>
                        <p><strong>Vendeur :</strong> <span th:text="${article.utilisateur.pseudo}"></span></p>
                        <a th:href="@{'/encheres/' + ${article.noArticle}}" class="btn">Voir</a>
                    </div>
                </div>
            </div>
            <button class="carousel-btn next">&#10095;</button>
        </div>
    </section>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const carousels = document.querySelectorAll('.carousel');

            carousels.forEach(carousel => {
                const prevBtn = carousel.querySelector('.carousel-btn.prev');
                const nextBtn = carousel.querySelector('.carousel-btn.next');
                const cardContainer = carousel.querySelector('.card-container');
                const cards = carousel.querySelectorAll('.card');

                const cardsPerView = 4;
                const totalCards = cards.length;
                let currentIndex = 0;

                // Largeur d'une carte (assumée identique)
                const cardWidth = cards[0].offsetWidth;

                function updateCarousel() {
                    const offset = currentIndex * cardWidth;
                    cardContainer.style.transform = `translateX(-${offset}px)`;
                }

                nextBtn.addEventListener('click', function() {
                    if (currentIndex < totalCards - cardsPerView) {
                        currentIndex++;
                        updateCarousel();
                    }
                });

                prevBtn.addEventListener('click', function() {
                    if (currentIndex > 0) {
                        currentIndex--;
                        updateCarousel();
                    }
                });

                // Ajuste le container pour éviter retour à la ligne
                cardContainer.style.width = `${cardWidth * totalCards}px`;
            });
        });
    </script>
</main>
</html>